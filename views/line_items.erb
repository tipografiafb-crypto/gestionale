<div class="mb-6">
  <h1 class="text-3xl font-bold text-gray-900">üîó Articoli da Elaborare</h1>
  <p class="text-gray-600 mt-2">Visione complessiva di tutti gli articoli in lavorazione</p>
</div>

<div class="mb-6 bg-white rounded-lg shadow-sm p-6">
  <form method="get" action="/line_items" class="flex gap-2">
    <input type="text" name="search" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Cerca per nome prodotto..." value="<%= @search_term %>">
    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition">Cerca</button>
    <% if @search_term.present? %>
      <a href="/line_items" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg text-sm font-medium transition">Azzera</a>
    <% end %>
  </form>
</div>

<div class="bg-white rounded-lg shadow-sm overflow-hidden">
  <% if @line_items.empty? %>
    <div class="p-8 text-center">
      <p class="text-gray-500">
        <% if @search_term.present? %>
          Nessun articolo trovato con il nome "<%= @search_term %>"
        <% else %>
          Nessun articolo in lavorazione
        <% end %>
      </p>
    </div>
  <% else %>
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead class="bg-gray-100 border-b border-gray-200">
          <tr>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Data Ordine</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Codice Ordine</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Negozio</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Nome Prodotto</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">SKU</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Quantit√†</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Stato</th>
            <th class="px-6 py-3 text-left font-semibold text-gray-700">Azioni</th>
          </tr>
        </thead>
        <tbody>
          <% @line_items.each do |li| %>
            <tr class="border-b border-gray-200 hover:bg-gray-50 transition">
              <td class="px-6 py-4 text-gray-700"><%= li[:order].created_at.strftime('%d-%m-%y') %></td>
              <td class="px-6 py-4"><a href="/orders/<%= li[:order].id %>" class="text-blue-600 hover:text-blue-800 font-medium"><%= li[:order].external_order_code %></a></td>
              <td class="px-6 py-4 text-gray-700"><%= li[:order].store.name %></td>
              <td class="px-6 py-4 font-semibold text-gray-900"><%= li[:product_name] %></td>
              <td class="px-6 py-4"><code class="bg-gray-100 px-2 py-1 rounded text-xs font-mono"><%= li[:item].sku %></code></td>
              <td class="px-6 py-4 text-gray-700"><%= li[:item].quantity %></td>
              <td class="px-6 py-4">
                <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold status-<%= li[:order].status %>">
                  <%= li[:order].status.gsub('_', ' ').upcase %>
                </span>
              </td>
              <td class="px-6 py-4">
                <a href="/orders/<%= li[:order].id %>" class="text-blue-600 hover:text-blue-800 text-lg" title="Visualizza ordine">üëÅÔ∏è</a>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="bg-blue-50 border-t border-gray-200 p-4 text-center">
      <p class="text-blue-800 font-semibold">Totale: <%= @line_items.count %> articoli da elaborare</p>
    </div>
  <% end %>
</div>
